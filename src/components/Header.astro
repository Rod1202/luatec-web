---
import { Image } from "astro:assets";
import logoBase from "../assets/branding/logo_base.avif";
const pathname = new URL(Astro.request.url).pathname;
const currentPath = pathname.slice(1); // remove the first "/"
---

<nav id="main-header" class="fixed top-0 left-0 w-full z-50 px-6 py-2 transition-all duration-300">
  <div class="max-w-7xl mx-auto flex items-center justify-between">
    <div class="flex items-center gap-2">
      <a href="/" aria-label="Volver al inicio" class="cursor-pointer transition-transform hover:scale-105">
        <Image 
          src={logoBase} 
          alt="LUATEC" 
          width={200}
          height={80}
          class="h-22 w-auto scale-110 origin-left translate-y-[1px] transition-transform duration-300" 
          loading="eager"
        />
      </a>
    </div>
    
    <div class="flex items-center gap-4">
        <a 
          class="flex items-center justify-center w-11 h-11 md:w-auto md:h-auto md:px-6 md:py-2.5 rounded-xl text-base font-bold bg-blue-600 hover:bg-blue-500 text-white shadow-[0_10px_25px_-5px_rgba(37,99,235,0.4)] transition-all duration-300 active:scale-95 border border-white/10" 
          href="/formulario"
          data-astro-prefetch
          aria-label="Contáctanos"
        >
          <span class="md:hidden material-symbols-outlined">mail</span>
          <span class="hidden md:inline">Contáctanos</span>
        </a>
    </div>
  </div>
</nav>

<script>
  const header = document.getElementById('main-header');
  // Target the logo image specifically for the shrink effect
  const logo = header?.querySelector('div a img'); 

  window.addEventListener('scroll', () => {
    const currentScrollY = window.scrollY;

    if (currentScrollY > 50) {
      // SCROLLED STATE
      header?.classList.add('backdrop-blur-sm');
      
      // Use efficient toggle for scale to ensure no conflicts
      logo?.classList.remove('scale-110', 'translate-y-[1px]');
      logo?.classList.add('scale-110');
      
    } else {
      // TOP STATE
      header?.classList.remove('backdrop-blur-sm');
      
      logo?.classList.remove('scale-90');
      logo?.classList.add('scale-110', 'translate-y-[1px]');
    }
    
    // NOTE: Padding (py-2) remains fixed. No layout shifts.
  });
</script>

